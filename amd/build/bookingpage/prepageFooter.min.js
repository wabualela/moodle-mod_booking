define("mod_booking/bookingpage/prepageFooter",["exports","jquery","mod_booking/bookit","local_wunderbyte_table/reload"],(function(_exports,_jquery,_bookit,_reload){var obj;Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.closeInline=closeInline,_exports.closeModal=closeModal,_exports.initFooterButtons=function(optionid,userid,shoppingcartisinstalled){console.log("initFooterButtons",optionid);let elements=document.querySelectorAll('[id^="'+SELECTORS_INLINEID+optionid+'_"] '+SELECTORS_INMODALFOOTER+" a");0===elements.length&&(elements=document.querySelectorAll('[id^="'+SELECTORS_MODALID+optionid+'_"] '+SELECTORS_INMODALFOOTER+" a"),_jquery.default.each((0,_jquery.default)('[id^="'+SELECTORS_MODALID+optionid+'_"]'),(function(){(0,_jquery.default)(this).on("hide.bs.modal",(function(){(0,_bookit.setBackModalVariables)(optionid)}))})));console.log("buttons found",elements),elements.forEach((async element=>{if(element&&!element.dataset.initialized){element.dataset.initialized=!0;const action=element.dataset.action;switch(console.log(element,action),action){case"closeinline":case"continuepost":case"checkout":console.log("closeinline",action),shoppingcartisinstalled&&("function"==typeof _systemImportTransformerGlobalIdentifier.define&&_systemImportTransformerGlobalIdentifier.define.amd?new Promise((function(resolve,reject){_systemImportTransformerGlobalIdentifier.require(["local_shopping_cart/cart"],resolve,reject)})):"undefined"!=typeof module&&module.exports&&"undefined"!=typeof require||"undefined"!=typeof module&&module.component&&_systemImportTransformerGlobalIdentifier.require&&"component"===_systemImportTransformerGlobalIdentifier.require.loader?Promise.resolve(require("local_shopping_cart/cart")):Promise.resolve(_systemImportTransformerGlobalIdentifier["local_shopping_cart/cart"])).then((cart=>{console.log(cart);window.location.href.indexOf("cashier.php")>0?cart.reinit(-1):cart.reinit()})).catch((()=>{console.log("local_shopping_cart/cart could not be loaded")})),function(optionid){_jquery.default.each((0,_jquery.default)('[id^="'+SELECTORS_INLINEID+optionid+'_"]'),(function(){(0,_jquery.default)(this).on("hide.bs.collapse",(function(){(0,_reload.reloadAllTables)()}))}))}()}element.addEventListener("click",(()=>{if(!element.classList.contains("hidden")&&"true"!=element.dataset.blocked)switch(action){case"back":(0,_bookit.backToPreviousPage)(optionid,userid);break;case"continue":case"continuepost":(0,_bookit.continueToNextPage)(optionid,userid);break;case"checkout":closeModal(optionid),window.location.href=element.dataset.href;break;case"closemodal":reloadOnBookingView(),closeModal(optionid);break;case"closeinline":reloadOnBookingView(),closeInline(optionid)}}))}}))},_jquery=(obj=_jquery)&&obj.__esModule?obj:{default:obj};var _systemImportTransformerGlobalIdentifier="undefined"!=typeof window?window:"undefined"!=typeof self?self:"undefined"!=typeof global?global:{};var SELECTORS_MODALID="sbPrePageModal_",SELECTORS_INLINEID="sbPrePageInline_",SELECTORS_INMODALFOOTER=" div.prepage-booking-footer";function closeModal(optionid){let reloadTables=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];_jquery.default.each((0,_jquery.default)('[id^="'+SELECTORS_MODALID+optionid+'_"]'),(async function(){(0,_jquery.default)(this).on("shown.bs.modal",(e=>{(0,_jquery.default)(e.currentTarget).off("shown.bs.modal"),console.log("modal hide after shown",e),(0,_jquery.default)(this).modal("hide"),reloadTables&&(0,_reload.reloadAllTables)()})),(0,_jquery.default)(this).modal("hide"),reloadTables&&(0,_reload.reloadAllTables)()}))}function closeInline(optionid){let reloadTables=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];_jquery.default.each((0,_jquery.default)('[id^="'+SELECTORS_INLINEID+optionid+'_"]'),(function(){(0,_jquery.default)(this).on("shown.bs.collapse",(e=>{(0,_jquery.default)(e.currentTarget).off("shown.bs.collapse"),console.log("collapse hide after shown",e),(0,_jquery.default)(this).collapse("toggle"),reloadTables&&(0,_reload.reloadAllTables)()})),(0,_jquery.default)(this).collapse("toggle"),reloadTables&&(0,_reload.reloadAllTables)()}))}function reloadOnBookingView(){window.location.href.indexOf("optionview.php")>=0&&window.location.reload()}}));

//# sourceMappingURL=prepageFooter.min.js.map